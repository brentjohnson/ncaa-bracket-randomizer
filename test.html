<html><head><title>test</title>
<style>
table { border-spacing: 0px 0px; }
[game] { width: 140px; border-right: 1px solid black; }
/* must go after [game] so border-right: None takes effect */
[upper] { border-bottom: 1px solid black; border-right: None; }
[lower] { border-bottom: 1px solid black; border-right: 1px solid black; }
</style>
<script src="js/jquery-1.5.min.js" type="text/javascript"></script>
<script>
//TODO: write a dummy console function so console.log doesn't kill shitty browsers
//TODO: add all my "vars". skipping for now because it eases debug

function selector(name, value) { return "[" + name + "='" + value + "']" } 

/* given a round game and whether it's the upper or lower game,
return an array [next round int, next game int, "u" or "l"] */
function nextGame(round, game) {
    return [round+1,
            game%2 == 1 ? game : game-1,
            game%2 == 1 ? "u"  : "l"];
    
}

/* clear the forward path for a team.

i.e. if I click team A, but I had previously picked team B to go all the way to
the finals, I should remove B from all games up to the finals */
function clearForwardInvalid() {
    $("[game] > [team="+opp+"]").each(function(_, elt) {
        console.log("_, elt: ", _, elt, team);
        game = $(elt).parent();
        if (parseInt(game.attr("round")) > 1) {
            game.html("&nbsp;");
        }
    });
}

function teamClick(evt) {
    console.log("clicked on ", evt.target.attributes.team);
    link = $(evt.target);
    
    dest = evt.target.attributes.href.value.substr(1).split("-");

    roundsel = selector("round", dest[0]);
    gamesel = selector("game", dest[1]);
    ulsel = selector(dest[2] == "u" ? "upper" : "lower", "");

    next = nextGame(parseInt(dest[0]), parseInt(dest[1]))

    copytgt = $(link.parent().html());
    nextlink = copytgt.attr("href",  '#' + next.join("-"));
    nextlink.click(teamClick);

    nextcell = $(roundsel+gamesel+ulsel);

    team = link.attr("team")
    opp = nextcell.children().attr("team")
    if (nextcell.children().length && opp != team) {
        clearForwardInvalid(opp);
    }

    nextcell.html(nextlink);
}

$(document).ready(function() {
    $("a[team]").click(teamClick);
});
</script>
</head>
<body>
<table>
    <tr>
        <td round=1 game=1 upper=""><a team=1 href="#2-1-u">Duke</a></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr><tr>
        <td game=1></td>
        <td round=2 game=1 upper="">&nbsp;</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr><tr>
        <td round=1 game=1 lower=""><a team=2 href="#2-1-u">Bethune-Cookman</a></td>
        <td round=2 game=1></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr><tr>
        <td></td>
        <td round=2 game=1></td>
        <td round=3 game=1 upper="">&nbsp;</td>
        <td></td>
        <td></td>
        <td></td>
    </tr><tr>
        <td round=1 game=2 upper=""><a team=3 href="#2-1-l">Texas A&M</a></td>
        <td round=2 game=1></td>
        <td round=3 game=1></td>
        <td></td>
        <td></td>
        <td></td>
    </tr><tr>
        <td round=1 game=2></td>
        <td round=2 game=1 lower="">&nbsp;</td>
        <td round=3 game=1></td>
        <td></td>
        <td></td>
        <td></td>
    </tr><tr>
        <td round=1 game=2 lower=""><a team=4 href="#2-1-l">Marquette</a></td>
        <td></td>
        <td round=3 game=1></td>
        <td></td>
        <td></td>
        <td></td>
    </tr><tr>
        <td>&nbsp;</td>
        <td></td>
        <td round=3 game=1></td>
        <td round=4 game=1 upper=""></td>
        <td></td>
        <td></td>
    </tr><tr>
        <td round=1 game=3 upper=""><a team=5 href="#2-2-u">UConn</a></td>
        <td></td>
        <td round=3 game=1></td>
        <td></td>
        <td></td>
        <td></td>
    </tr><tr>
        <td game=1></td>
        <td round=2 game=2 upper="">&nbsp;</td>
        <td round=3 game=1></td>
        <td></td>
        <td></td>
        <td></td>
    </tr><tr>
        <td round=1 game=3 lower=""><a team=6 href="#2-2-u">Oklahoma St.</a></td>
        <td round=2 game=2></td>
        <td round=3 game=1></td>
        <td></td>
        <td></td>
        <td></td>
    </tr><tr>
        <td></td>
        <td round=2 game=2></td>
        <td round=3 game=1 lower="">&nbsp;</td>
        <td></td>
        <td></td>
        <td></td>
    </tr><tr>
        <td round=1 game=4 upper=""><a team=7 href="#2-2-l">Clemson</a></td>
        <td round=2 game=2></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr><tr>
        <td round=1 game=4></td>
        <td round=2 game=2 lower="">&nbsp;</td>
        <td></td>
        <td></td>
        <td></td>
    </tr><tr>
        <td round=1 game=4 lower=""><a team=8 href="#2-2-l">St. John's</a></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr><tr>
</table>
</body>
</html>
